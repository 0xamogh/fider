box: golang:1.8

services:
  - id: postgres
    tag: 9.6
    env:
      POSTGRES_USER: wechy_test
      POSTGRES_PASSWORD: wechy_test-pw

build-assets:
  box: node:6.10
  steps:
    - script:
      name: npm install
      code: |
        npm install

build:
  steps:
    - setup-go-workspace

    # Get dependencies
    - script:
        name: get dotenv
        code: |
          go get github.com/joho/godotenv/cmd/godotenv

    # Test the project
    - script:
        name: run test
        code: |
          make ci-test